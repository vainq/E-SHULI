export const BASE=import.meta.env.VITE_API_BASE_URL;async function err(res){try{const j=await res.json();return typeof j==='string'?j:j.error||j.message||res.statusText;}catch{return await res.text().catch(()=>res.statusText);} }export async function apiGet(path,params){const url=new URL(path,BASE);if(params)Object.entries(params).forEach(([k,v])=>v!=null&&url.searchParams.set(k,String(v)));const res=await fetch(url.toString());if(!res.ok)throw new Error(await err(res));return res.json();}export async function apiPost(path,body,token){const url=new URL(path,BASE);const res=await fetch(url.toString(),{method:'POST',headers:{'Content-Type':'application/json',...(token?{Authorization:`Bearer ${token}`}:{})},body:JSON.stringify(body||{})});if(!res.ok)throw new Error(await err(res));return res.json();}
