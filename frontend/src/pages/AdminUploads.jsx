import { useState } from 'react';import { apiPost } from '../lib/api';import { getToken, clearToken } from '../lib/auth';import { useNavigate } from 'react-router-dom';export default function AdminUploads(){const token=getToken();const nav=useNavigate();const[nTitle,setNTitle]=useState(''),[nSubject,setNSubject]=useState(''),[nLevel,setNLevel]=useState('Secondary'),[nDesc,setNDesc]=useState(''),[nUrl,setNUrl]=useState('');const[pTitle,setPTitle]=useState(''),[pSubject,setPSubject]=useState(''),[pYear,setPYear]=useState('2024'),[pLevel,setPLevel]=useState('Secondary'),[pSource,setPSource]=useState('REB'),[pUrl,setPUrl]=useState('');async function addENote(){await apiPost('/api/e-notes',{title:nTitle,subject:nSubject,level:nLevel,description:nDesc,fileUrl:nUrl},token);alert('E-Note added');}async function addPastPaper(){await apiPost('/api/past-papers',{title:pTitle,subject:pSubject,year:Number(pYear),level:pLevel,source:pSource,url:pUrl},token);alert('Past paper added');}async function refreshJobs(){await apiPost('/api/jobs/refresh',{},token);alert('Jobs refresh triggered');}async function refreshPapers(){await apiPost('/api/past-papers/refresh',{},token);alert('Past papers refresh triggered');}return(<div className='grid gap-6'><div className='flex justify-between items-center'><h1 className='text-2xl font-bold'>Admin Dashboard</h1><button className='text-sm underline' onClick={()=>{clearToken();nav('/admin');}}>Sign out</button></div><section className='grid md:grid-cols-2 gap-6'><div className='border rounded-xl p-4 bg-white'><h2 className='font-bold mb-2'>Upload E-Note</h2><div className='grid gap-2'><input className='border rounded px-3 py-2' placeholder='Title' value={nTitle} onChange={e=>setNTitle(e.target.value)}/><input className='border rounded px-3 py-2' placeholder='Subject' value={nSubject} onChange={e=>setNSubject(e.target.value)}/><select className='border rounded px-3 py-2' value={nLevel} onChange={e=>setNLevel(e.target.value)}><option>Secondary</option><option>TVET</option><option>University</option></select><input className='border rounded px-3 py-2' placeholder='Short description' value={nDesc} onChange={e=>setNDesc(e.target.value)}/><input className='border rounded px-3 py-2' placeholder='File URL (PDF/Drive)' value={nUrl} onChange={e=>setNUrl(e.target.value)}/><button onClick={addENote} className='px-4 py-2 rounded bg-black text-white'>Add E-Note</button></div></div><div className='border rounded-xl p-4 bg-white'><h2 className='font-bold mb-2'>Add Past Paper</h2><div className='grid gap-2'><input className='border rounded px-3 py-2' placeholder='Title' value={pTitle} onChange={e=>setPTitle(e.target.value)}/><input className='border rounded px-3 py-2' placeholder='Subject' value={pSubject} onChange={e=>setPSubject(e.target.value)}/><input className='border rounded px-3 py-2' placeholder='Year' value={pYear} onChange={e=>setPYear(e.target.value)}/><select className='border rounded px-3 py-2' value={pLevel} onChange={e=>setPLevel(e.target.value)}><option>Secondary</option><option>TVET</option><option>University</option></select><select className='border rounded px-3 py-2' value={pSource} onChange={e=>setPSource(e.target.value)}><option>REB</option><option>NESA</option><option>MINEDUC</option><option>Other</option></select><input className='border rounded px-3 py-2' placeholder='PDF URL' value={pUrl} onChange={e=>setPUrl(e.target.value)}/><button onClick={addPastPaper} className='px-4 py-2 rounded bg-black text-white'>Add Past Paper</button></div></div></section><section className='border rounded-xl p-4 bg-white'><h2 className='font-bold mb-2'>Refresh Data</h2><div className='flex flex-wrap gap-2'><button onClick={refreshJobs} className='px-4 py-2 rounded bg-gray-800 text-white'>Refresh Jobs</button><button onClick={refreshPapers} className='px-4 py-2 rounded bg-gray-800 text-white'>Refresh Past Papers</button></div></section></div>);}
