const axios=require('axios');const cheerio=require('cheerio');const Job=require('../models/Job');async function refreshJobs(){const url='https://umucuruzi.com/';const html=(await axios.get(url,{timeout:15000})).data;const $=cheerio.load(html);const seen=new Set();const list=[];$('a').each((_i,el)=>{const href=$(el).attr('href')||'';const title=($(el).text()||'').trim();if(!href||!/umucuruzi\.com/.test(href))return;if(!/job|career|vacanc|position/i.test(href+' '+title))return;const clean=href.split('#')[0];if(seen.has(clean))return;seen.add(clean);const parent=$(el).closest('article,div,li').text().replace(/\s+/g,' ').trim();const description=(parent||title).slice(0,300);list.push({title:title||'Job',description,url:clean});});let n=0;for(const j of list.slice(0,50)){await Job.updateOne({url:j.url},{$set:{...j,source:'umucuruzi.com'}},{upsert:true});n++;}return n;}module.exports=refreshJobs;
