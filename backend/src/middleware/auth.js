const jwt=require('jsonwebtoken');const{CONFIG}=require('../config');function requireAuth(req,res,next){const h=req.headers.authorization||'';const t=h.startsWith('Bearer ')?h.slice(7):null;if(!t)return res.status(401).json({error:'Unauthorized'});try{req.user=jwt.verify(t,CONFIG.JWT_SECRET);next();}catch{res.status(401).json({error:'Invalid token'});}}exports.requireAuth=requireAuth;
