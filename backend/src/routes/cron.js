const{Router}=require('express');const refreshJobs=require('../jobs/fetchJobs');const refreshPapers=require('../jobs/scrapePastPapers');const r=Router();function ok(req){const h=req.headers['x-cron-token'];const q=req.query?.token;const t=h||q;return t&&t===process.env.CRON_TOKEN;}r.post('/jobs',async(req,res)=>{if(!ok(req))return res.status(401).json({error:'Unauthorized'});res.json({refreshed:await refreshJobs()});});r.post('/past-papers',async(req,res)=>{if(!ok(req))return res.status(401).json({error:'Unauthorized'});res.json({refreshed:await refreshPapers()});});module.exports=r;
